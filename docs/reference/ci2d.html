<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create 2-dimensional empirical confidence regions — ci2d • gplots</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create 2-dimensional empirical confidence regions — ci2d" />
<meta property="og:description" content="Create 2-dimensional empirical confidence regions from provided data." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gplots</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/talgalili/gplots/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create 2-dimensional empirical confidence regions</h1>
    
    <div class="hidden name"><code>ci2d.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create 2-dimensional empirical confidence regions from provided data.</p>
    </div>

    <pre class="usage"><span class='fu'>ci2d</span>(<span class='no'>x</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
     <span class='kw'>nbins</span><span class='kw'>=</span><span class='fl'>51</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"bkde2D"</span>,<span class='st'>"hist2d"</span>),
     <span class='no'>bandwidth</span>, <span class='kw'>factor</span><span class='kw'>=</span><span class='fl'>1.0</span>,
     <span class='kw'>ci.levels</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.50</span>,<span class='fl'>0.75</span>,<span class='fl'>0.90</span>,<span class='fl'>0.95</span>,<span class='fl'>0.975</span>),
     <span class='kw'>show</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"filled.contour"</span>,<span class='st'>"contour"</span>,<span class='st'>"image"</span>,<span class='st'>"none"</span>),
     <span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>topo.colors</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>breaks</span>)-<span class='fl'>1</span>),
     <span class='kw'>show.points</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
     <span class='kw'>pch</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='st'>"pch"</span>),
     <span class='kw'>points.col</span><span class='kw'>=</span><span class='st'>"red"</span>,
     <span class='no'>xlab</span>, <span class='no'>ylab</span>,
     <span class='no'>...</span>)
<span class='co'># S3 method for ci2d</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>x</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>either a vector containing the x coordinates
    or a matrix with 2 columns.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>a vector contianing the y coordinates, not required if `x'
    is matrix</p></td>
    </tr>
    <tr>
      <th>nbins</th>
      <td><p>number of bins in each dimension. May be a scalar or a
    2 element vector.  Defaults to 51.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>One of "bkde2D" (for KernSmooth::bdke2d) or "hist2d"
    (for gplots::hist2d) specifyting the name of the method to create
    the 2-d density summarizing the data.  Defaults to "bkde2D".</p></td>
    </tr>
    <tr>
      <th>bandwidth</th>
      <td><p>Bandwidth to use for <code><a href='https://rdrr.io/pkg/KernSmooth/man/bkde2D.html'>KernSmooth::bkde2D</a></code>.
    See below for default value.</p></td>
    </tr>
    <tr>
      <th>factor</th>
      <td><p>Numeric scaling factor for bandwidth.  Useful for
    exploring effect of changing the bandwidth.  Defaults to 1.0.</p></td>
    </tr>
    <tr>
      <th>ci.levels</th>
      <td><p>Confidence level(s) to use for plotting
    data. Defaults to <code><a href='https://rdrr.io/r/base/c.html'>c(0.5, 0.75, 0.9, 0.95, 0.975)</a></code></p></td>
    </tr>
    <tr>
      <th>show</th>
      <td><p>Plot type to be displaed.  One of "filled.contour",
    "contour", "image", or "none".  Defaults to "filled.contour".</p></td>
    </tr>
    <tr>
      <th>show.points</th>
      <td><p>Boolean indicating whether original data values
    should be plotted.  Defaults to <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>pch</th>
      <td><p>Point type for plots.  See <code>points</code> for details.</p></td>
    </tr>
    <tr>
      <th>points.col</th>
      <td><p>Point color for plotting original data. Defaiults to
  "red".</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>Colors to use for plots.</p></td>
    </tr>
    <tr>
      <th>xlab, ylab</th>
      <td><p>Axis labels</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to <code><a href='https://rdrr.io/pkg/KernSmooth/man/bkde2D.html'>KernSmooth::bkde2D</a></code>
    or <code><a href='hist2d.html'>gplots::hist2d</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function utilizes either <code><a href='https://rdrr.io/pkg/KernSmooth/man/bkde2D.html'>KernSmooth::bkde2D</a></code> or
  <code><a href='hist2d.html'>gplots::hist2d</a></code> to estmate a 2-dimensional density of the data
  passed as an argument.  This density is then used to create and
  (optionally) display confidence regions.</p>
<p>When <code>bandwidth</code> is ommited and <code>method="bkde2d"</code>,
  <code><a href='https://rdrr.io/pkg/KernSmooth/man/dpik.html'>KernSmooth::dpik</a></code> is appled in x and y dimensions to select the
  bandwidth.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Confidence intervals generated by ci2d are <em>approximate</em>, and
  are subject to biases and/or artifacts induced by the binning or
  kernel smoothing method, bin locations, bin sizes, and kernel bandwidth.</p>
<p>The <code>conf2d</code> function in the <span class="pkg">r2d2</span> package may create a more
  accurate confidence region, and reports the actual proportion of
  points inside the region.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>ci2d</code> object consisting of a list containing (at least) the
  following elements:</p>
<dt>nobs</dt><dd><p>number of original data points</p></dd>
  <dt>x</dt><dd><p>x position of each density estimate bin</p></dd>
  <dt>y</dt><dd><p>y position of each density estimate bin</p></dd>
  <dt>density</dt><dd><p>Matrix containing the probability density of each bin
    (count in bin/total count)</p></dd>
  <dt>cumDensity</dt><dd><p>Matrix where each element contains the cumulative
    probability density of all elements with the same density (used to
    create the confidence region plots)</p></dd>
  <dt>contours</dt><dd><p>List of contours of each confidence region.</p></dd>
  <dt>call</dt><dd><p>Call used to create this object</p></dd>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/KernSmooth/man/bkde2D.html'>bkde2D</a></code>, <code>conf2d</code>,
  <code><a href='https://rdrr.io/pkg/KernSmooth/man/dpik.html'>dpik</a></code>, <code><a href='hist2d.html'>hist2d</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>   <span class='co'>####</span>
   <span class='co'>## Basic usage </span>
   <span class='co'>####</span>
   <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>geyser</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"MASS"</span>)

   <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='no'>geyser</span>$<span class='no'>duration</span>
   <span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>geyser</span>$<span class='no'>waiting</span>

   <span class='co'># 2-d confidence intervals based on binned kernel density estimate</span>
   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>)                   <span class='co'># filled contour plot</span></div><div class='img'><img src='ci2d-1.png' alt='' width='700' height='433' /></div><div class='input'>   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>, <span class='kw'>show.points</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='co'># show original data</span></div><div class='img'><img src='ci2d-2.png' alt='' width='700' height='433' /></div><div class='input'>

   <span class='co'># image plot</span>
   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>, <span class='kw'>show</span><span class='kw'>=</span><span class='st'>"image"</span>)</div><div class='input'>   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>, <span class='kw'>show</span><span class='kw'>=</span><span class='st'>"image"</span>, <span class='kw'>show.points</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='img'><img src='ci2d-3.png' alt='' width='700' height='433' /></div><div class='input'>
   <span class='co'># contour plot</span>
   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>, <span class='kw'>show</span><span class='kw'>=</span><span class='st'>"contour"</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"black"</span>)</div><div class='input'>   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>, <span class='kw'>show</span><span class='kw'>=</span><span class='st'>"contour"</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"black"</span>, <span class='kw'>show.points</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='img'><img src='ci2d-4.png' alt='' width='700' height='433' /></div><div class='input'>
   <span class='co'>####</span>
   <span class='co'>## Control Axis scales</span>
   <span class='co'>####</span>
   <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>2000</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>4</span>)
   <span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>2000</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1</span>)

   <span class='co'># 2-d confidence intervals based on binned kernel density estimate</span>
   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>)</div><div class='img'><img src='ci2d-5.png' alt='' width='700' height='433' /></div><div class='input'>
   <span class='co'># 2-d confidence intervals based on 2d histogram</span>
   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"hist2d"</span>, <span class='kw'>nbins</span><span class='kw'>=</span><span class='fl'>25</span>)</div><div class='img'><img src='ci2d-6.png' alt='' width='700' height='433' /></div><div class='input'>
   <span class='co'># Require same scale for each axis, this looks oval</span>
   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>, <span class='kw'>range.x</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>20</span>,<span class='fl'>20</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>20</span>,<span class='fl'>20</span>)))</div><div class='output co'>#&gt; <span class='warning'>Warning: Binning grid too coarse for current (small) bandwidth: consider increasing 'gridsize'</span></div><div class='img'><img src='ci2d-7.png' alt='' width='700' height='433' /></div><div class='input'>   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"hist2d"</span>, <span class='kw'>same.scale</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>nbins</span><span class='kw'>=</span><span class='fl'>25</span>) <span class='co'># hist2d </span></div><div class='img'><img src='ci2d-8.png' alt='' width='700' height='433' /></div><div class='input'>
   <span class='co'>####</span>
   <span class='co'>## Control smoothing and binning </span>
   <span class='co'>####</span>
   <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>2000</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>4</span>)
   <span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>2000</span>, <span class='kw'>mean</span><span class='kw'>=</span><span class='no'>x</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>2</span>)

   <span class='co'># Default 2-d confidence intervals based on binned kernel density estimate</span>
   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>)</div><div class='img'><img src='ci2d-9.png' alt='' width='700' height='433' /></div><div class='input'>
   <span class='co'># change the smoother bandwidth</span>
   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>,
        <span class='kw'>bandwidth</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span>(<span class='no'>x</span>)/<span class='fl'>8</span>, <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span>(<span class='no'>y</span>)/<span class='fl'>8</span>)
       )</div><div class='img'><img src='ci2d-10.png' alt='' width='700' height='433' /></div><div class='input'>
   <span class='co'># change the smoother number of bins</span>
   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>, <span class='kw'>nbins</span><span class='kw'>=</span><span class='fl'>10</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Binning grid too coarse for current (small) bandwidth: consider increasing 'gridsize'</span></div><div class='img'><img src='ci2d-11.png' alt='' width='700' height='433' /></div><div class='input'>   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>)</div><div class='img'><img src='ci2d-12.png' alt='' width='700' height='433' /></div><div class='input'>   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>, <span class='kw'>nbins</span><span class='kw'>=</span><span class='fl'>100</span>)</div><div class='img'><img src='ci2d-13.png' alt='' width='700' height='433' /></div><div class='input'>
   <span class='co'># Default 2-d confidence intervals based on 2d histogram</span>
   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"hist2d"</span>, <span class='kw'>show.points</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='img'><img src='ci2d-14.png' alt='' width='700' height='433' /></div><div class='input'>
   <span class='co'># change the number of histogram bins</span>
   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>, <span class='kw'>nbin</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"hist2d"</span>, <span class='kw'>show.points</span><span class='kw'>=</span><span class='fl'>TRUE</span> )</div><div class='img'><img src='ci2d-15.png' alt='' width='700' height='433' /></div><div class='input'>   <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>, <span class='kw'>nbin</span><span class='kw'>=</span><span class='fl'>25</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"hist2d"</span>, <span class='kw'>show.points</span><span class='kw'>=</span><span class='fl'>TRUE</span> )</div><div class='img'><img src='ci2d-16.png' alt='' width='700' height='433' /></div><div class='input'>
   <span class='co'>####</span>
   <span class='co'>## Perform plotting manually</span>
   <span class='co'>####</span>
   <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>geyser</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"MASS"</span>)

   <span class='co'># let ci2d handle plotting contours...</span>
   <span class='fu'>ci2d</span>(<span class='no'>geyser</span>$<span class='no'>duration</span>, <span class='no'>geyser</span>$<span class='no'>waiting</span>, <span class='kw'>show</span><span class='kw'>=</span><span class='st'>"contour"</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"black"</span>)</div><div class='img'><img src='ci2d-17.png' alt='' width='700' height='433' /></div><div class='input'>
   <span class='co'># call contour() directly, show the 90 percent CI, and the mean point </span>
   <span class='no'>est</span> <span class='kw'>&lt;-</span> <span class='fu'>ci2d</span>(<span class='no'>geyser</span>$<span class='no'>duration</span>, <span class='no'>geyser</span>$<span class='no'>waiting</span>, <span class='kw'>show</span><span class='kw'>=</span><span class='st'>"none"</span>)
   <span class='fu'><a href='https://rdrr.io/r/graphics/contour.html'>contour</a></span>(<span class='no'>est</span>$<span class='no'>x</span>, <span class='no'>est</span>$<span class='no'>y</span>, <span class='no'>est</span>$<span class='no'>cumDensity</span>,
           <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"duration"</span>, <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"waiting"</span>,
           <span class='kw'>levels</span><span class='kw'>=</span><span class='fl'>0.90</span>, <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>2</span>)</div><div class='input'>   <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>geyser</span>$<span class='no'>duration</span>), <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>geyser</span>$<span class='no'>waiting</span>),
         <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"red"</span>, <span class='kw'>pch</span><span class='kw'>=</span><span class='st'>"X"</span>)</div><div class='img'><img src='ci2d-18.png' alt='' width='700' height='433' /></div><div class='input'>

   <span class='co'>####</span>
   <span class='co'>## Extract confidence region values</span>
   <span class='co'>###</span>
   <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>geyser</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"MASS"</span>)

   <span class='co'>## Empirical 90 percent confidence limits</span>
   <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span>( <span class='no'>geyser</span>$<span class='no'>duration</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.05</span>, <span class='fl'>0.95</span>) )</div><div class='output co'>#&gt;       5%      95% 
#&gt; 1.781667 4.803333 </div><div class='input'>   <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span>( <span class='no'>geyser</span>$<span class='no'>waiting</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.05</span>, <span class='fl'>0.95</span>) )</div><div class='output co'>#&gt;  5% 95% 
#&gt;  49  92 </div><div class='input'>
   <span class='co'>## Bivariate 90 percent confidence region</span>
   <span class='no'>est</span> <span class='kw'>&lt;-</span> <span class='fu'>ci2d</span>(<span class='no'>geyser</span>$<span class='no'>duration</span>, <span class='no'>geyser</span>$<span class='no'>waiting</span>, <span class='kw'>show</span><span class='kw'>=</span><span class='st'>"none"</span>)
   <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>est</span>$<span class='no'>contours</span>) <span class='co'>## show available contours</span></div><div class='output co'>#&gt;  [1] "0.5"   "0.5"   "0.5"   "0.75"  "0.75"  "0.9"   "0.9"   "0.9"   "0.95" 
#&gt; [10] "0.975" "0.975" "0.975" "1"     "1"     "1"     "1"    </div><div class='input'>
   <span class='no'>ci.90</span> <span class='kw'>&lt;-</span> <span class='no'>est</span>$<span class='no'>contours</span>[<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>est</span>$<span class='no'>contours</span>)<span class='kw'>==</span><span class='st'>"0.9"</span>]  <span class='co'># get region(s)</span>
   <span class='no'>ci.90</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='no'>ci.90</span><span class='kw'>[[</span><span class='fl'>1</span>]],<span class='fl'>NA</span>, <span class='no'>ci.90</span><span class='kw'>[[</span><span class='fl'>2</span>]], <span class='fl'>NA</span>, <span class='no'>ci.90</span><span class='kw'>[[</span><span class='fl'>3</span>]]) <span class='co'># join them</span>

   <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>ci.90</span>)                  <span class='co'># show full contour</span></div><div class='output co'>#&gt;            x        y
#&gt; 1   1.526652 78.00100
#&gt; 2   1.520334 78.43451
#&gt; 3   1.505526 79.90177
#&gt; 4   1.498197 81.36902
#&gt; 5   1.490886 82.83628
#&gt; 6   1.479440 84.30353
#&gt; 7   1.462897 85.77079
#&gt; 8   1.449958 87.23804
#&gt; 9   1.440848 88.70530
#&gt; 10  1.442839 90.17255
#&gt; 11  1.454784 91.63981
#&gt; 12  1.472003 93.10706
#&gt; 13  1.500685 94.57432
#&gt; 14  1.526652 95.19393
#&gt; 15  1.559131 96.04157
#&gt; 16  1.617806 97.50883
#&gt; 17  1.627590 97.68333
#&gt; 18  1.714635 98.97608
#&gt; 19  1.728529 99.16754
#&gt; 20  1.829467 99.52422
#&gt; 21  1.902190 98.97608
#&gt; 22  1.930405 98.75198
#&gt; 23  2.001441 97.50883
#&gt; 24  2.031344 96.96819
#&gt; 25  2.085418 96.04157
#&gt; 26  2.132282 95.33502
#&gt; 27  2.215860 94.57432
#&gt; 28  2.233221 94.38900
#&gt; 29  2.317325 93.10706
#&gt; 30  2.334159 92.65774
#&gt; 31  2.364668 91.63981
#&gt; 32  2.379204 90.17255
#&gt; 33  2.383578 88.70530
#&gt; 34  2.386307 87.23804
#&gt; 35  2.388831 85.77079
#&gt; 36  2.399318 84.30353
#&gt; 37  2.435098 82.94130
#&gt; 38  2.536036 83.00782
#&gt; 39  2.576349 82.83628
#&gt; 40  2.636974 82.27676
#&gt; 41  2.667152 81.36902
#&gt; 42  2.688972 79.90177
#&gt; 43  2.694766 78.43451
#&gt; 44  2.684505 76.96726
#&gt; 45  2.655260 75.50000
#&gt; 46  2.636974 75.15474
#&gt; 47  2.569526 74.03274
#&gt; 48  2.536036 73.63059
#&gt; 49  2.435098 72.97800
#&gt; 50  2.405518 72.56549
#&gt; 51  2.334159 71.55041
#&gt; 52  2.313730 71.09823
#&gt; 53  2.251786 69.63098
#&gt; 54  2.233221 69.32254
#&gt; 55  2.142469 68.16372
#&gt; 56  2.132282 68.03823
#&gt; 57  2.031344 67.61998
#&gt; 58  1.930405 67.86785
#&gt; 59  1.904180 68.16372
#&gt; 60  1.829467 68.88220
#&gt; 61  1.764631 69.63098
#&gt; 62  1.728529 70.03697
#&gt; 63  1.661616 71.09823
#&gt; 64  1.627590 71.79147
#&gt; 65  1.592978 72.56549
#&gt; 66  1.562754 74.03274
#&gt; 67  1.543863 75.50000
#&gt; 68  1.533815 76.96726
#&gt; 69  1.526652 78.00100
#&gt; 70        NA       NA
#&gt; 71  2.737913 84.36406
#&gt; 72  2.702601 85.77079
#&gt; 73  2.702726 87.23804
#&gt; 74  2.728780 88.70530
#&gt; 75  2.737913 88.92268
#&gt; 76  2.838851 89.49949
#&gt; 77  2.874943 88.70530
#&gt; 78  2.890153 87.23804
#&gt; 79  2.894175 85.77079
#&gt; 80  2.904096 84.30353
#&gt; 81  2.939790 83.29632
#&gt; 82  2.956368 82.83628
#&gt; 83  3.040728 81.45426
#&gt; 84  3.047848 81.36902
#&gt; 85  3.040728 80.91434
#&gt; 86  2.988633 79.90177
#&gt; 87  2.939790 79.77276
#&gt; 88  2.931426 79.90177
#&gt; 89  2.897488 81.36902
#&gt; 90  2.841431 82.83628
#&gt; 91  2.838851 82.84583
#&gt; 92  2.742613 84.30353
#&gt; 93  2.737913 84.36406
#&gt; 94        NA       NA
#&gt; 95  3.343544 80.55432
#&gt; 96  3.264362 81.36902
#&gt; 97  3.262814 82.83628
#&gt; 98  3.343544 83.86099
#&gt; 99  3.444482 84.13361
#&gt; 100 3.545420 83.98935
#&gt; 101 3.564810 84.30353
#&gt; 102 3.646359 85.16856
#&gt; 103 3.667276 85.77079
#&gt; 104 3.711371 87.23804
#&gt; 105 3.747297 88.21581
#&gt; 106 3.761295 88.70530
#&gt; 107 3.799563 90.17255
#&gt; 108 3.848236 91.61093
#&gt; 109 3.850149 91.63981
#&gt; 110 3.949174 92.85127
#&gt; 111 4.050113 93.07323
#&gt; 112 4.129626 93.10706
#&gt; 113 4.151051 93.11728
#&gt; 114 4.251989 93.52810
#&gt; 115 4.352928 93.67499
#&gt; 116 4.417983 93.10706
#&gt; 117 4.453866 92.74089
#&gt; 118 4.504468 91.63981
#&gt; 119 4.554805 90.67480
#&gt; 120 4.577976 90.17255
#&gt; 121 4.620989 88.70530
#&gt; 122 4.655743 87.29638
#&gt; 123 4.657465 87.23804
#&gt; 124 4.675729 85.77079
#&gt; 125 4.679825 84.30353
#&gt; 126 4.688109 82.83628
#&gt; 127 4.713564 81.36902
#&gt; 128 4.756682 80.27291
#&gt; 129 4.770533 79.90177
#&gt; 130 4.810875 78.43451
#&gt; 131 4.847559 76.96726
#&gt; 132 4.857620 76.04432
#&gt; 133 4.863988 75.50000
#&gt; 134 4.857620 74.76464
#&gt; 135 4.851404 74.03274
#&gt; 136 4.826268 72.56549
#&gt; 137 4.822707 71.09823
#&gt; 138 4.857620 70.14403
#&gt; 139 4.879648 69.63098
#&gt; 140 4.958558 68.64356
#&gt; 141 4.993910 68.16372
#&gt; 142 5.059497 67.26021
#&gt; 143 5.091469 66.69647
#&gt; 144 5.131592 65.22921
#&gt; 145 5.151538 63.76196
#&gt; 146 5.147964 62.29470
#&gt; 147 5.130174 60.82745
#&gt; 148 5.111120 59.36019
#&gt; 149 5.113432 57.89294
#&gt; 150 5.132810 56.42568
#&gt; 151 5.151330 54.95843
#&gt; 152 5.160435 53.90290
#&gt; 153 5.165968 53.49117
#&gt; 154 5.181295 52.02392
#&gt; 155 5.186603 50.55666
#&gt; 156 5.160435 49.79061
#&gt; 157 5.149455 49.08941
#&gt; 158 5.106121 47.62215
#&gt; 159 5.059497 46.71834
#&gt; 160 5.031109 46.15490
#&gt; 161 4.958558 45.21630
#&gt; 162 4.899437 44.68764
#&gt; 163 4.857620 44.34279
#&gt; 164 4.756682 43.99259
#&gt; 165 4.655743 43.69261
#&gt; 166 4.564788 43.22039
#&gt; 167 4.554805 43.13902
#&gt; 168 4.453866 42.53020
#&gt; 169 4.352928 42.38644
#&gt; 170 4.251989 42.94142
#&gt; 171 4.227531 43.22039
#&gt; 172 4.151051 43.84742
#&gt; 173 4.050113 44.17547
#&gt; 174 3.960667 44.68764
#&gt; 175 3.949174 44.74952
#&gt; 176 3.848236 46.03264
#&gt; 177 3.841648 46.15490
#&gt; 178 3.793690 47.62215
#&gt; 179 3.769244 49.08941
#&gt; 180 3.750798 50.55666
#&gt; 181 3.747297 50.87603
#&gt; 182 3.724850 52.02392
#&gt; 183 3.705749 53.49117
#&gt; 184 3.688124 54.95843
#&gt; 185 3.677953 56.42568
#&gt; 186 3.679643 57.89294
#&gt; 187 3.695465 59.36019
#&gt; 188 3.720085 60.82745
#&gt; 189 3.747297 62.17827
#&gt; 190 3.749205 62.29470
#&gt; 191 3.761016 63.76196
#&gt; 192 3.752194 65.22921
#&gt; 193 3.747297 65.55238
#&gt; 194 3.726328 66.69647
#&gt; 195 3.693492 68.16372
#&gt; 196 3.646359 69.23910
#&gt; 197 3.623416 69.63098
#&gt; 198 3.567201 71.09823
#&gt; 199 3.545420 71.72056
#&gt; 200 3.514052 72.56549
#&gt; 201 3.499421 74.03274
#&gt; 202 3.493647 75.50000
#&gt; 203 3.491131 76.96726
#&gt; 204 3.476675 78.43451
#&gt; 205 3.444482 79.45455
#&gt; 206 3.401653 79.90177
#&gt; 207 3.343544 80.55432</div><div class='input'>   <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='no'>ci.90</span>$<span class='no'>x</span>, <span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>)    <span class='co'># range for duration</span></div><div class='output co'>#&gt; [1] 1.440848 5.186603</div><div class='input'>   <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='no'>ci.90</span>$<span class='no'>y</span>, <span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>)    <span class='co'># range for waiting</span></div><div class='output co'>#&gt; [1] 42.38644 99.52422</div><div class='input'>
   <span class='co'>####</span>
   <span class='co'>## Visually compare confidence regions </span>
   <span class='co'>####</span>
   <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>geyser</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"MASS"</span>)

   <span class='co'>## Bivariate smoothed 90 percent confidence region</span>
   <span class='no'>est</span> <span class='kw'>&lt;-</span> <span class='fu'>ci2d</span>(<span class='no'>geyser</span>$<span class='no'>duration</span>, <span class='no'>geyser</span>$<span class='no'>waiting</span>, <span class='kw'>show</span><span class='kw'>=</span><span class='st'>"none"</span>)
   <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>est</span>$<span class='no'>contours</span>) <span class='co'>## show available contours</span></div><div class='output co'>#&gt;  [1] "0.5"   "0.5"   "0.5"   "0.75"  "0.75"  "0.9"   "0.9"   "0.9"   "0.95" 
#&gt; [10] "0.975" "0.975" "0.975" "1"     "1"     "1"     "1"    </div><div class='input'>
   <span class='no'>ci.90</span> <span class='kw'>&lt;-</span> <span class='no'>est</span>$<span class='no'>contours</span>[<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>est</span>$<span class='no'>contours</span>)<span class='kw'>==</span><span class='st'>"0.9"</span>]  <span class='co'># get region(s)</span>
   <span class='no'>ci.90</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='no'>ci.90</span><span class='kw'>[[</span><span class='fl'>1</span>]],<span class='fl'>NA</span>, <span class='no'>ci.90</span><span class='kw'>[[</span><span class='fl'>2</span>]], <span class='fl'>NA</span>, <span class='no'>ci.90</span><span class='kw'>[[</span><span class='fl'>3</span>]]) <span class='co'># join them</span>

   <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>( <span class='no'>waiting</span> ~ <span class='no'>duration</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>geyser</span>,
         <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Comparison of 90 percent confidence regions"</span> )</div><div class='input'>   <span class='fu'><a href='https://rdrr.io/r/graphics/polygon.html'>polygon</a></span>( <span class='no'>ci.90</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"green"</span>, <span class='kw'>border</span><span class='kw'>=</span><span class='st'>"green"</span>, <span class='kw'>density</span><span class='kw'>=</span><span class='fl'>10</span>)</div><div class='input'>
   <span class='co'>## Univariate Normal-Theory 90 percent confidence region</span>
   <span class='no'>mean.x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>geyser</span>$<span class='no'>duration</span>)
   <span class='no'>mean.y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>geyser</span>$<span class='no'>waiting</span>)
   <span class='no'>sd.x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span>(<span class='no'>geyser</span>$<span class='no'>duration</span>)
   <span class='no'>sd.y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span>(<span class='no'>geyser</span>$<span class='no'>waiting</span>)

   <span class='no'>t.value</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>qt</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.05</span>,<span class='fl'>0.95</span>), <span class='kw'>df</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>geyser</span>$<span class='no'>duration</span>), <span class='kw'>lower</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
   <span class='no'>ci.x</span> <span class='kw'>&lt;-</span> <span class='no'>mean.x</span> +  <span class='no'>t.value</span>* <span class='no'>sd.x</span>
   <span class='no'>ci.y</span> <span class='kw'>&lt;-</span> <span class='no'>mean.y</span> +  <span class='no'>t.value</span>* <span class='no'>sd.y</span>

   <span class='fu'><a href='plotCI.html'>plotCI</a></span>(<span class='no'>mean.x</span>, <span class='no'>mean.y</span>,
          <span class='kw'>li</span><span class='kw'>=</span><span class='no'>ci.x</span>[<span class='fl'>1</span>],
          <span class='kw'>ui</span><span class='kw'>=</span><span class='no'>ci.x</span>[<span class='fl'>2</span>],
          <span class='kw'>barcol</span><span class='kw'>=</span><span class='st'>"blue"</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"blue"</span>,
          <span class='kw'>err</span><span class='kw'>=</span><span class='st'>"x"</span>,
          <span class='kw'>pch</span><span class='kw'>=</span><span class='st'>"X"</span>,
          <span class='kw'>add</span><span class='kw'>=</span><span class='fl'>TRUE</span> )</div><div class='input'>
   <span class='fu'><a href='plotCI.html'>plotCI</a></span>(<span class='no'>mean.x</span>, <span class='no'>mean.y</span>,
          <span class='kw'>li</span><span class='kw'>=</span><span class='no'>ci.y</span>[<span class='fl'>1</span>],
          <span class='kw'>ui</span><span class='kw'>=</span><span class='no'>ci.y</span>[<span class='fl'>2</span>],
          <span class='kw'>barcol</span><span class='kw'>=</span><span class='st'>"blue"</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"blue"</span>,
          <span class='kw'>err</span><span class='kw'>=</span><span class='st'>"y"</span>,
          <span class='kw'>pch</span><span class='kw'>=</span><span class='fl'>NA</span>,
          <span class='kw'>add</span><span class='kw'>=</span><span class='fl'>TRUE</span> )</div><div class='input'>
<span class='co'>#   rect(ci.x[1], ci.y[1], ci.x[2], ci.y[2], border="blue",</span>
<span class='co'>#        density=5,</span>
<span class='co'>#        angle=45,</span>
<span class='co'>#        col="blue" )</span>


   <span class='co'>## Empirical univariate 90 percent confidence region</span>
   <span class='no'>box</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>( <span class='kw'>x</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span>( <span class='no'>geyser</span>$<span class='no'>duration</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.05</span>, <span class='fl'>0.95</span> )),
                 <span class='kw'>y</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span>( <span class='no'>geyser</span>$<span class='no'>waiting</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.05</span>, <span class='fl'>0.95</span> )) )

   <span class='fu'><a href='https://rdrr.io/r/graphics/rect.html'>rect</a></span>(<span class='no'>box</span>[<span class='fl'>1</span>,<span class='fl'>1</span>], <span class='no'>box</span>[<span class='fl'>1</span>,<span class='fl'>2</span>], <span class='no'>box</span>[<span class='fl'>2</span>,<span class='fl'>1</span>], <span class='no'>box</span>[<span class='fl'>2</span>,<span class='fl'>2</span>], <span class='kw'>border</span><span class='kw'>=</span><span class='st'>"red"</span>,
        <span class='kw'>density</span><span class='kw'>=</span><span class='fl'>5</span>,
        <span class='kw'>angle</span><span class='kw'>=</span>-<span class='fl'>45</span>,
        <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"red"</span> )</div><div class='input'>
   <span class='co'>## now a nice legend</span>
   <span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span>( <span class='st'>"topright"</span>, <span class='kw'>legend</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"       Region type"</span>,
                                <span class='st'>"Univariate Normal Theory"</span>,
                                <span class='st'>"Univarite Empirical"</span>,
                                <span class='st'>"Smoothed Bivariate"</span>),
           <span class='kw'>lwd</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>NA</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>),
           <span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"black"</span>,<span class='st'>"blue"</span>,<span class='st'>"red"</span>,<span class='st'>"green"</span>),
           <span class='kw'>lty</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>NA</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>)
         )</div><div class='img'><img src='ci2d-19.png' alt='' width='700' height='433' /></div><div class='input'>
   <span class='co'>####</span>
   <span class='co'>## Test with a large number of points</span>
   <span class='co'>####</span>
   <span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
   <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>60000</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1</span>)
   <span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>40000</span>, <span class='kw'>mean</span><span class='kw'>=</span><span class='no'>x</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1</span>),
           <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>20000</span>, <span class='kw'>mean</span><span class='kw'>=</span><span class='no'>x</span>+<span class='fl'>4</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1</span>) )

   <span class='fu'><a href='hist2d.html'>hist2d</a></span>(<span class='no'>x</span>,<span class='no'>y</span>)
   <span class='no'>ci</span> <span class='kw'>&lt;-</span> <span class='fu'>ci2d</span>(<span class='no'>x</span>,<span class='no'>y</span>)
   <span class='no'>ci</span>
   }</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gregory R. Warnes, Ben Bolker, Lodewijk Bonebakker, Robert Gentleman, Wolfgang Huber, Andy Liaw, Thomas Lumley, Martin Maechler, Arni Magnusson, Steffen Moeller, Marc Schwartz, Bill Venables, Tal Galili.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


