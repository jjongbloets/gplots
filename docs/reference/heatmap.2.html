<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Enhanced Heat Map — heatmap.2 • gplots</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Enhanced Heat Map — heatmap.2" />
<meta property="og:description" content="A heat map is a false color image (basically
  image(t(x))) with a dendrogram added to the left side
  and/or to the top.  Typically, reordering of the rows and columns
  according to some set of values (row or column means) within the
  restrictions imposed by the dendrogram is carried out.
This heatmap provides a number of extensions to the standard R
  heatmap function." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gplots</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/talgalili/gplots/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Enhanced Heat Map</h1>
    
    <div class="hidden name"><code>heatmap.2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A heat map is a false color image (basically
  <code><a href='https://rdrr.io/r/graphics/image.html'>image</a>(t(x))</code>) with a dendrogram added to the left side
  and/or to the top.  Typically, reordering of the rows and columns
  according to some set of values (row or column means) within the
  restrictions imposed by the dendrogram is carried out.</p>
<p>This heatmap provides a number of extensions to the standard R
  <code><a href='https://rdrr.io/r/stats/heatmap.html'>heatmap</a></code> function.</p>
    </div>

    <pre class="usage"><span class='fu'>heatmap.2</span> (<span class='no'>x</span>,

           <span class='co'># dendrogram control</span>
           <span class='kw'>Rowv</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
           <span class='kw'>Colv</span><span class='kw'>=</span><span class='kw'>if</span>(<span class='no'>symm</span>)<span class='st'>"Rowv"</span> <span class='kw'>else</span> <span class='fl'>TRUE</span>,
           <span class='kw'>distfun</span> <span class='kw'>=</span> <span class='no'>dist</span>,
           <span class='kw'>hclustfun</span> <span class='kw'>=</span> <span class='no'>hclust</span>,
           <span class='kw'>dendrogram</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"both"</span>,<span class='st'>"row"</span>,<span class='st'>"column"</span>,<span class='st'>"none"</span>),
           <span class='kw'>reorderfun</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>d</span>, <span class='no'>w</span>) <span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span>(<span class='no'>d</span>, <span class='no'>w</span>),
           <span class='kw'>symm</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,

           <span class='co'># data scaling</span>
           <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"none"</span>,<span class='st'>"row"</span>, <span class='st'>"column"</span>),
           <span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>,

           <span class='co'># image plot</span>
           <span class='kw'>revC</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/identical.html'>identical</a></span>(<span class='no'>Colv</span>, <span class='st'>"Rowv"</span>),
           <span class='no'>add.expr</span>,

           <span class='co'># mapping data to colors</span>
           <span class='no'>breaks</span>,
           <span class='kw'>symbreaks</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span>(<span class='no'>x</span> <span class='kw'>&lt;</span> <span class='fl'>0</span>, <span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='kw'>||</span> <span class='no'>scale</span><span class='kw'>!=</span><span class='st'>"none"</span>,

           <span class='co'># colors</span>
           <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"heat.colors"</span>,

           <span class='co'># block sepration</span>
           <span class='no'>colsep</span>,
           <span class='no'>rowsep</span>,
           <span class='kw'>sepcolor</span><span class='kw'>=</span><span class='st'>"white"</span>,
           <span class='kw'>sepwidth</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.05</span>,<span class='fl'>0.05</span>),

           <span class='co'># cell labeling</span>
           <span class='no'>cellnote</span>,
           <span class='kw'>notecex</span><span class='kw'>=</span><span class='fl'>1.0</span>,
           <span class='kw'>notecol</span><span class='kw'>=</span><span class='st'>"cyan"</span>,
           <span class='kw'>na.color</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='st'>"bg"</span>),

           <span class='co'># level trace</span>
           <span class='kw'>trace</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"column"</span>,<span class='st'>"row"</span>,<span class='st'>"both"</span>,<span class='st'>"none"</span>),
           <span class='kw'>tracecol</span><span class='kw'>=</span><span class='st'>"cyan"</span>,
           <span class='kw'>hline</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span>(<span class='no'>breaks</span>),
           <span class='kw'>vline</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span>(<span class='no'>breaks</span>),
           <span class='kw'>linecol</span><span class='kw'>=</span><span class='no'>tracecol</span>,

           <span class='co'># Row/Column Labeling</span>
           <span class='kw'>margins</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>, <span class='fl'>5</span>),
           <span class='no'>ColSideColors</span>,
           <span class='no'>RowSideColors</span>,
           <span class='kw'>cexRow</span> <span class='kw'>=</span> <span class='fl'>0.2</span> + <span class='fl'>1</span>/<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span>(<span class='no'>nr</span>),
           <span class='kw'>cexCol</span> <span class='kw'>=</span> <span class='fl'>0.2</span> + <span class='fl'>1</span>/<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span>(<span class='no'>nc</span>),
           <span class='kw'>labRow</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
           <span class='kw'>labCol</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
           <span class='kw'>srtRow</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
           <span class='kw'>srtCol</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
           <span class='kw'>adjRow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>NA</span>),
           <span class='kw'>adjCol</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>NA</span>,<span class='fl'>0</span>),
           <span class='kw'>offsetRow</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
           <span class='kw'>offsetCol</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
           <span class='kw'>colRow</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
           <span class='kw'>colCol</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,

           <span class='co'># color key + density info</span>
           <span class='kw'>key</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
           <span class='kw'>keysize</span> <span class='kw'>=</span> <span class='fl'>1.5</span>,
           <span class='kw'>density.info</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"histogram"</span>,<span class='st'>"density"</span>,<span class='st'>"none"</span>),
           <span class='kw'>denscol</span><span class='kw'>=</span><span class='no'>tracecol</span>,
           <span class='kw'>symkey</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span>(<span class='no'>x</span> <span class='kw'>&lt;</span> <span class='fl'>0</span>, <span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='kw'>||</span> <span class='no'>symbreaks</span>,
           <span class='kw'>densadj</span> <span class='kw'>=</span> <span class='fl'>0.25</span>,
           <span class='kw'>key.title</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
           <span class='kw'>key.xlab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
           <span class='kw'>key.ylab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
           <span class='kw'>key.xtickfun</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
           <span class='kw'>key.ytickfun</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
           <span class='kw'>key.par</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(),

           <span class='co'># plot labels</span>
           <span class='kw'>main</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
           <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
           <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,

           <span class='co'># plot layout</span>
           <span class='kw'>lmat</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
           <span class='kw'>lhei</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
           <span class='kw'>lwid</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,

           <span class='co'># extras</span>
           <span class='kw'>extrafun</span><span class='kw'>=</span><span class='kw'>NULL</span>,
           <span class='no'>...</span>
           )</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>numeric matrix of the values to be plotted.</p></td>
    </tr>
    <tr>
      <th>Rowv</th>
      <td><p>determines if and how the <em>row</em> dendrogram should be
    reordered.	By default, it is TRUE, which implies dendrogram is
    computed and reordered based on row means. If NULL or FALSE, then no
    dendrogram is computed and no reordering is done. If a
    <code><a href='https://rdrr.io/r/stats/dendrogram.html'>dendrogram</a></code>, then it is used "as-is", ie
    without any reordering. If a vector of integers, then dendrogram is
    computed and reordered based on the order of the vector.</p></td>
    </tr>
    <tr>
      <th>Colv</th>
      <td><p>determines if and how the <em>column</em> dendrogram should
    be reordered.	Has the options as the <code>Rowv</code> argument above and
    <em>additionally</em> when <code>x</code> is a square matrix,
    <code>Colv="Rowv"</code> means that columns should be treated identically
    to the rows.</p></td>
    </tr>
    <tr>
      <th>distfun</th>
      <td><p>function used to compute the distance (dissimilarity)
    between both rows and columns.  Defaults to <code><a href='https://rdrr.io/r/stats/dist.html'>dist</a></code>.</p></td>
    </tr>
    <tr>
      <th>hclustfun</th>
      <td><p>function used to compute the hierarchical clustering
    when <code>Rowv</code> or <code>Colv</code> are not dendrograms.  Defaults to
    <code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code>.</p></td>
    </tr>
    <tr>
      <th>dendrogram</th>
      <td><p>character string indicating whether to draw 'none',
    'row', 'column' or 'both' dendrograms.  Defaults to 'both'. However,
    if Rowv (or Colv) is FALSE or NULL and dendrogram is 'both', then a
    warning is issued and Rowv (or Colv) arguments are honoured.</p></td>
    </tr>
    <tr>
      <th>reorderfun</th>
      <td><p><code>function(d, w)</code> of dendrogram and weights for
    reordering the row and column dendrograms.  The default uses
    <code><a href='https://rdrr.io/r/stats/stats-package.html'>stats</a>{reorder.dendrogram}</code></p></td>
    </tr>
    <tr>
      <th>symm</th>
      <td><p>logical indicating if <code>x</code> should be treated
    <b>symm</b>etrically; can only be true when <code>x</code> is a
    square matrix.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>character indicating if the values should be centered and
    scaled in either the row direction or the column direction, or
    none.  The default is <code>"none"</code>.</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>logical indicating whether <code>NA</code>'s should be removed.</p></td>
    </tr>
    <tr>
      <th>revC</th>
      <td><p>logical indicating if the column order should be
    <code><a href='https://rdrr.io/r/base/rev.html'>rev</a></code>ersed for plotting, such that e.g., for the
    symmetric case, the symmetry axis is as usual.</p></td>
    </tr>
    <tr>
      <th>add.expr</th>
      <td><p>expression that will be evaluated after the call to
    <code>image</code>.  Can be used to add components to the plot.</p></td>
    </tr>
    <tr>
      <th>breaks</th>
      <td><p>(optional) Either a numeric vector indicating the
    splitting points for binning <code>x</code> into colors, or a integer
    number of break points to be used, in which case the break points
    will be spaced equally between <code><a href='https://rdrr.io/r/base/Extremes.html'>min(x)</a></code> and <code><a href='https://rdrr.io/r/base/Extremes.html'>max(x)</a></code>.</p></td>
    </tr>
    <tr>
      <th>symbreaks</th>
      <td><p>Boolean indicating whether breaks should be
    made symmetric about 0. Defaults to <code>TRUE</code> if the data includes
    negative values, and to <code>FALSE</code> otherwise.</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>colors used for the image. Defaults to heat colors
    (<code>heat.colors</code>).</p></td>
    </tr>
    <tr>
      <th>colsep, rowsep, sepcolor</th>
      <td><p>(optional) vector of integers
    indicating which columns or rows should be separated from the
    preceding columns or rows by a narrow space of color
    <code>sepcolor</code>.</p></td>
    </tr>
    <tr>
      <th>sepwidth</th>
      <td><p>(optional) Vector of length 2 giving the width
    (colsep) or height (rowsep) the separator box drawn by colsep and
    rowsep as a function of the width (colsep) or height (rowsep) of a
    cell. Defaults to <code><a href='https://rdrr.io/r/base/c.html'>c(0.05, 0.05)</a></code></p></td>
    </tr>
    <tr>
      <th>cellnote</th>
      <td><p>(optional) matrix of character strings which will be
    placed within each color cell, e.g. p-value symbols.</p></td>
    </tr>
    <tr>
      <th>notecex</th>
      <td><p>(optional) numeric scaling factor for <code>cellnote</code>
    items.</p></td>
    </tr>
    <tr>
      <th>notecol</th>
      <td><p>(optional) character string specifying the color for
    <code>cellnote</code> text.  Defaults to "cyan".</p></td>
    </tr>
    <tr>
      <th>na.color</th>
      <td><p>Color to use for missing value (<code>NA</code>). Defaults
    to the plot background color.</p></td>
    </tr>
    <tr>
      <th>trace</th>
      <td><p>character string indicating whether a solid "trace" line
    should be drawn across 'row's or down 'column's, 'both' or 'none'.
    The distance of the line from the center of each color-cell is
    proportional to the size of the measurement. Defaults to 'column'.</p></td>
    </tr>
    <tr>
      <th>tracecol</th>
      <td><p>character string giving the color for "trace"
    line. Defaults to "cyan".</p></td>
    </tr>
    <tr>
      <th>hline, vline, linecol</th>
      <td><p>Vector of values within cells where a
    horizontal or vertical dotted line should be drawn.  The color of
    the line is controlled by <code>linecol</code>.  Horizontal  lines are only
    plotted if <code>trace</code> is 'row' or 'both'.  Vertical lines are only
    drawn if <code>trace</code> 'column' or 'both'.   <code>hline</code> and
    <code>vline</code> default to the median of the breaks, <code>linecol</code>
    defaults to the value of <code>tracecol</code>.</p></td>
    </tr>
    <tr>
      <th>margins</th>
      <td><p>numeric vector of length 2 containing the margins
    (see <code><a href='https://rdrr.io/r/graphics/par.html'>par</a>(mar= *)</code>) for column and row names,
    respectively.</p></td>
    </tr>
    <tr>
      <th>ColSideColors</th>
      <td><p>(optional) character vector of length
    <code><a href='https://rdrr.io/r/base/nrow.html'>ncol(x)</a></code> containing the color names for a horizontal side bar
    that may be used to annotate the columns of <code>x</code>.</p></td>
    </tr>
    <tr>
      <th>RowSideColors</th>
      <td><p>(optional) character vector of length
    <code><a href='https://rdrr.io/r/base/nrow.html'>nrow(x)</a></code> containing the color names for a vertical side bar
    that may be used to annotate the rows of <code>x</code>.</p></td>
    </tr>
    <tr>
      <th>cexRow, cexCol</th>
      <td><p>positive numbers, used as <code>cex.axis</code> in
    for the row or column axis labeling.  The defaults currently only
    use number of rows or columns, respectively.</p></td>
    </tr>
    <tr>
      <th>labRow, labCol</th>
      <td><p>character vectors with row and column labels to
    use; these default to <code><a href='https://rdrr.io/r/base/colnames.html'>rownames(x)</a></code> or <code><a href='https://rdrr.io/r/base/colnames.html'>colnames(x)</a></code>,
    respectively.</p></td>
    </tr>
    <tr>
      <th>srtRow, srtCol</th>
      <td><p>angle of row/column labels, in degrees from
    horizontal</p></td>
    </tr>
    <tr>
      <th>adjRow, adjCol</th>
      <td><p>2-element vector giving the (left-right,
    top-bottom) justification of row/column labels (relative to the text
    orientation).</p></td>
    </tr>
    <tr>
      <th>offsetRow, offsetCol</th>
      <td><p>Number of character-width spaces to
    place between row/column labels and the edge of the plotting
    region.</p></td>
    </tr>
    <tr>
      <th>colRow, colCol</th>
      <td><p>color of row/column labels, either a scalar to
    set the color of all labels the same, or a vector providing the
    colors of each label item</p></td>
    </tr>
    <tr>
      <th>key</th>
      <td><p>logical indicating whether a color-key should be shown.</p></td>
    </tr>
    <tr>
      <th>keysize</th>
      <td><p>numeric value indicating the size of the key</p></td>
    </tr>
    <tr>
      <th>density.info</th>
      <td><p>character string indicating whether to superimpose
    a 'histogram', a 'density' plot, or no plot ('none') on the
    color-key.</p></td>
    </tr>
    <tr>
      <th>denscol</th>
      <td><p>character string giving the color for the density
    display specified by <code>density.info</code>, defaults to the same value
    as <code>tracecol</code>.</p></td>
    </tr>
    <tr>
      <th>symkey</th>
      <td><p>Boolean indicating whether the color key should be
    made symmetric about 0. Defaults to <code>TRUE</code> if the data includes
    negative values, and to <code>FALSE</code> otherwise.</p></td>
    </tr>
    <tr>
      <th>densadj</th>
      <td><p>Numeric scaling value for tuning the kernel width when
    a density plot is drawn on the color key.  (See the <code>adjust</code>
    parameter for the <code>density</code> function for details.)  Defaults to
    0.25.</p></td>
    </tr>
    <tr>
      <th>key.title</th>
      <td><p>main title of the color key. If set to NA no title
    will be plotted.</p></td>
    </tr>
    <tr>
      <th>key.xlab</th>
      <td><p>x axis label of the color key. If set to NA no label
    will be plotted.</p></td>
    </tr>
    <tr>
      <th>key.ylab</th>
      <td><p>y axis label of the color key. If set to NA no label
    will be plotted.</p></td>
    </tr>
    <tr>
      <th>key.xtickfun</th>
      <td><p>function computing tick location and labels for
    the xaxis of the color key. Returns a named list containing
    parameters that can be passed to <code>axis</code>. See examples.</p></td>
    </tr>
    <tr>
      <th>key.ytickfun</th>
      <td><p>function computing tick location and labels for
    the y axis of the color key. Returns a named list containing
    parameters that can be passed to <code>axis</code>.  See examples.</p></td>
    </tr>
    <tr>
      <th>key.par</th>
      <td><p>graphical parameters for the color key. Named list that
    can be passed to <code>par</code>.</p></td>
    </tr>
    <tr>
      <th>main, xlab, ylab</th>
      <td><p>main, x- and y-axis titles; defaults to none.</p></td>
    </tr>
    <tr>
      <th>lmat, lhei, lwid</th>
      <td><p>visual layout: position matrix, column height,
    column width.  See below for details</p></td>
    </tr>
    <tr>
      <th>extrafun</th>
      <td><p>A function to be called after all other work. See
    examples.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments passed on to <code><a href='https://rdrr.io/r/graphics/image.html'>image</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If either <code>Rowv</code> or <code>Colv</code> are dendrograms they are honored
  (and not reordered).	Otherwise, dendrograms are computed as
  <code>dd &lt;- as.dendrogram(hclustfun(distfun(X)))</code> where <code>X</code> is
  either <code>x</code> or <code><a href='https://rdrr.io/r/base/t.html'>t(x)</a></code>.<br /></p>
<p>If either is a vector (of &#8220;weights&#8221;) then the appropriate
  dendrogram is reordered according to the supplied values subject to
  the constraints imposed by the dendrogram, by <code><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a>(dd,
    Rowv)</code>, in the row case.
  <!-- %% -->
  If either is missing, as by default, then the ordering of the
  corresponding dendrogram is by the mean value of the rows/columns,
  i.e., in the case of rows, <code>Rowv &lt;- rowMeans(x, na.rm=na.rm)</code>.
  <!-- %% -->
  If either is <code><a href='https://rdrr.io/r/base/NULL.html'>NULL</a></code>, <em>no reordering</em> will be done for
  the corresponding side.</p>
<p>If <code>scale="row"</code> (or <code>scale="col"</code>) the rows (columns) are
  scaled to have mean zero and standard deviation one.  There is some
  empirical evidence from genomic plotting that this is useful.</p>
<p>The default colors range from red to white (<code>heat.colors</code>) and
  are not pretty.  Consider using enhancements such as the
  <span class="pkg">RColorBrewer</span> package,
  <a href='https://cran.r-project.org/package=RColorBrewer'>https://cran.r-project.org/package=RColorBrewer</a>
  to select better colors.</p>
<p>By default four components will be displayed in the plot.  At the top
  left is the color key, top right is the column dendrogram, bottom left
  is the row dendrogram, bottom right is the image plot.  When
  RowSideColor or ColSideColor are provided, an additional row or column
  is inserted in the appropriate location.   This layout can be
  overriden by specifiying appropriate values for <code>lmat</code>,
  <code>lwid</code>, and <code>lhei</code>.  <code>lmat</code> controls the relative
  postition of each element, while <code>lwid</code> controls the column
  width, and <code>lhei</code> controls the row height. See the help page for
  <code><a href='https://rdrr.io/r/graphics/layout.html'>layout</a></code> for details on how to use these
  arguments.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The original rows and columns are reordered to match the dendrograms
  <code>Rowv</code> and <code>Colv</code> (if present).</p>
<p><code>heatmap.2()</code> uses <code><a href='https://rdrr.io/r/graphics/layout.html'>layout</a></code> to arragent the plot
  elements. Consequentially, it can <b>not</b> be used in a multi
  column/row layout using <code><a href='https://rdrr.io/r/graphics/layout.html'>layout</a>(...)</code>,
  <code><a href='https://rdrr.io/r/graphics/par.html'>par</a>(mfrow=...)</code> or <code>(mfcol=...)</code>.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Invisibly, a list with components</p>
<dt>rowInd</dt><dd><p>row index permutation vector as returned by
    <code><a href='https://rdrr.io/r/stats/order.dendrogram.html'>order.dendrogram</a></code>.</p></dd>
  <dt>colInd</dt><dd><p>column index permutation vector.</p></dd>
  <dt>call</dt><dd><p>the matched call</p></dd>
  <dt>rowMeans, rowSDs</dt><dd><p>mean and standard deviation of each row: only
    present if <code>scale="row"</code></p></dd>
  <dt>colMeans, colSDs</dt><dd><p>mean and standard deviation of each column: only
    present if <code>scale="column"</code></p></dd>
  <dt>carpet</dt><dd><p>reordered and scaled 'x' values used generate the main
    'carpet'</p></dd>
  <dt>rowDendrogram</dt><dd><p>row dendrogram, if present</p></dd>
  <dt>colDendrogram</dt><dd><p>column dendrogram, if present</p></dd>
  <dt>breaks</dt><dd><p>values used for color break points</p></dd>
  <dt>col</dt><dd><p>colors used</p></dd>
  <dt>vline</dt><dd><p>center-line value used for column trace, present only if
    <code>trace="both"</code> or <code>trace="column"</code></p></dd>
  <dt>hline</dt><dd><p>center-line value used for row trace, present only if
    <code>trace="both"</code> or <code>trace="row"</code></p></dd>
  <dt>colorTable</dt><dd><p>A three-column data frame providing the lower and upper
    bound and color for each bin</p></dd>
  <dt>layout</dt><dd><p>A named list containing the values used for
    <code>lmat</code>, <code>lhei</code>, and <code>lwid</code>.</p></dd>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/graphics/image.html'>image</a></code>, <code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'> <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>mtcars</span>)
 <span class='no'>x</span>  <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>mtcars</span>)
 <span class='no'>rc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>rainbow</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>x</span>), <span class='kw'>start</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>end</span><span class='kw'>=</span><span class='fl'>.3</span>)
 <span class='no'>cc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>rainbow</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>x</span>), <span class='kw'>start</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>end</span><span class='kw'>=</span><span class='fl'>.3</span>)

 <span class='co'>##</span>
 <span class='co'>## demonstrate the effect of row and column dendrogram options</span>
 <span class='co'>##</span>
 <span class='fu'>heatmap.2</span>(<span class='no'>x</span>)                    <span class='co'>## default - dendrogram plotted and reordering done.</span></div><div class='img'><img src='heatmap.2-1.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>dendrogram</span><span class='kw'>=</span><span class='st'>"none"</span>) <span class='co'>##  no dendrogram plotted, but reordering done.</span></div><div class='img'><img src='heatmap.2-2.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>dendrogram</span><span class='kw'>=</span><span class='st'>"row"</span>)  <span class='co'>## row dendrogram plotted and row reordering done.</span></div><div class='img'><img src='heatmap.2-3.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>dendrogram</span><span class='kw'>=</span><span class='st'>"col"</span>)  <span class='co'>## col dendrogram plotted and col reordering done.</span></div><div class='img'><img src='heatmap.2-4.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>keysize</span><span class='kw'>=</span><span class='fl'>2</span>)         <span class='co'>## default - dendrogram plotted and reordering done.</span></div><div class='img'><img src='heatmap.2-5.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>Rowv</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>dendrogram</span><span class='kw'>=</span><span class='st'>"both"</span>) <span class='co'>## generates a warning!</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discrepancy: Rowv is FALSE, while dendrogram is `both'. Omitting row dendogram.</span></div><div class='img'><img src='heatmap.2-6.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>Rowv</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>dendrogram</span><span class='kw'>=</span><span class='st'>"both"</span>)  <span class='co'>## generates a warning!</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discrepancy: Rowv is FALSE, while dendrogram is `both'. Omitting row dendogram.</span></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>Colv</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>dendrogram</span><span class='kw'>=</span><span class='st'>"both"</span>) <span class='co'>## generates a warning!</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discrepancy: Colv is FALSE, while dendrogram is `both'. Omitting column dendogram.</span></div><div class='img'><img src='heatmap.2-7.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='co'>## Reorder dendrogram by branch means rather than sums</span>
 <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>reorderfun</span><span class='kw'>=</span><span class='kw'>function</span>(<span class='no'>d</span>, <span class='no'>w</span>) <span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span>(<span class='no'>d</span>, <span class='no'>w</span>, <span class='kw'>agglo.FUN</span> <span class='kw'>=</span> <span class='no'>mean</span>) )</div><div class='img'><img src='heatmap.2-8.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='co'>## plot a sub-cluster using the same color coding as for the full heatmap</span>
 <span class='no'>full</span> <span class='kw'>&lt;-</span> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>)</div><div class='img'><img src='heatmap.2-9.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>Colv</span><span class='kw'>=</span><span class='no'>full</span>$<span class='no'>colDendrogram</span><span class='kw'>[[</span><span class='fl'>2</span>]], <span class='kw'>breaks</span><span class='kw'>=</span><span class='no'>full</span>$<span class='no'>breaks</span>)  <span class='co'># column subset</span></div><div class='img'><img src='heatmap.2-10.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>Rowv</span><span class='kw'>=</span><span class='no'>full</span>$<span class='no'>rowDendrogram</span><span class='kw'>[[</span><span class='fl'>1</span>]], <span class='kw'>breaks</span><span class='kw'>=</span><span class='no'>full</span>$<span class='no'>breaks</span>)  <span class='co'># row subset</span></div><div class='img'><img src='heatmap.2-11.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>Colv</span><span class='kw'>=</span><span class='no'>full</span>$<span class='no'>colDendrogram</span><span class='kw'>[[</span><span class='fl'>2</span>]],
              <span class='kw'>Rowv</span><span class='kw'>=</span><span class='no'>full</span>$<span class='no'>rowDendrogram</span><span class='kw'>[[</span><span class='fl'>1</span>]], <span class='kw'>breaks</span><span class='kw'>=</span><span class='no'>full</span>$<span class='no'>breaks</span>)  <span class='co'># both</span></div><div class='img'><img src='heatmap.2-12.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='co'>## Show effect of row and column label rotation</span>
 <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>srtCol</span><span class='kw'>=</span><span class='kw'>NULL</span>)</div><div class='img'><img src='heatmap.2-13.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>srtCol</span><span class='kw'>=</span><span class='fl'>0</span>,   <span class='kw'>adjCol</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.5</span>,<span class='fl'>1</span>) )</div><div class='img'><img src='heatmap.2-14.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>srtCol</span><span class='kw'>=</span><span class='fl'>45</span>,  <span class='kw'>adjCol</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>)   )</div><div class='img'><img src='heatmap.2-15.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>srtCol</span><span class='kw'>=</span><span class='fl'>135</span>, <span class='kw'>adjCol</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>0</span>)   )</div><div class='img'><img src='heatmap.2-16.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>srtCol</span><span class='kw'>=</span><span class='fl'>180</span>, <span class='kw'>adjCol</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.5</span>,<span class='fl'>0</span>) )</div><div class='img'><img src='heatmap.2-17.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>srtCol</span><span class='kw'>=</span><span class='fl'>225</span>, <span class='kw'>adjCol</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>0</span>)   ) <span class='co'>## not very useful</span></div><div class='img'><img src='heatmap.2-18.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>srtCol</span><span class='kw'>=</span><span class='fl'>270</span>, <span class='kw'>adjCol</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>0.5</span>) )</div><div class='img'><img src='heatmap.2-19.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>srtCol</span><span class='kw'>=</span><span class='fl'>315</span>, <span class='kw'>adjCol</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>)   )</div><div class='img'><img src='heatmap.2-20.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>srtCol</span><span class='kw'>=</span><span class='fl'>360</span>, <span class='kw'>adjCol</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.5</span>,<span class='fl'>1</span>) )</div><div class='img'><img src='heatmap.2-21.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>srtRow</span><span class='kw'>=</span><span class='fl'>45</span>, <span class='kw'>adjRow</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>) )</div><div class='img'><img src='heatmap.2-22.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>srtRow</span><span class='kw'>=</span><span class='fl'>45</span>, <span class='kw'>adjRow</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>), <span class='kw'>srtCol</span><span class='kw'>=</span><span class='fl'>45</span>, <span class='kw'>adjCol</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>) )</div><div class='img'><img src='heatmap.2-23.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>srtRow</span><span class='kw'>=</span><span class='fl'>45</span>, <span class='kw'>adjRow</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>), <span class='kw'>srtCol</span><span class='kw'>=</span><span class='fl'>270</span>, <span class='kw'>adjCol</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>0.5</span>) )</div><div class='img'><img src='heatmap.2-24.png' alt='' width='700' height='433' /></div><div class='input'>

 <span class='co'>## Show effect of offsetRow/offsetCol (only works when srtRow/srtCol is</span>
 <span class='co'>## not also present)</span>
 <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>offsetRow</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>offsetCol</span><span class='kw'>=</span><span class='fl'>0</span>)</div><div class='img'><img src='heatmap.2-25.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>offsetRow</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>offsetCol</span><span class='kw'>=</span><span class='fl'>1</span>)</div><div class='img'><img src='heatmap.2-26.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>offsetRow</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>offsetCol</span><span class='kw'>=</span><span class='fl'>2</span>)</div><div class='img'><img src='heatmap.2-27.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>offsetRow</span><span class='kw'>=</span>-<span class='fl'>1</span>, <span class='kw'>offsetCol</span><span class='kw'>=</span>-<span class='fl'>1</span>)</div><div class='img'><img src='heatmap.2-28.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>srtRow</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>srtCol</span><span class='kw'>=</span><span class='fl'>90</span>, <span class='kw'>offsetRow</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>offsetCol</span><span class='kw'>=</span><span class='fl'>0</span>)</div><div class='img'><img src='heatmap.2-29.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>srtRow</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>srtCol</span><span class='kw'>=</span><span class='fl'>90</span>, <span class='kw'>offsetRow</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>offsetCol</span><span class='kw'>=</span><span class='fl'>1</span>)</div><div class='img'><img src='heatmap.2-30.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>srtRow</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>srtCol</span><span class='kw'>=</span><span class='fl'>90</span>, <span class='kw'>offsetRow</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>offsetCol</span><span class='kw'>=</span><span class='fl'>2</span>)</div><div class='img'><img src='heatmap.2-31.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>srtRow</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>srtCol</span><span class='kw'>=</span><span class='fl'>90</span>, <span class='kw'>offsetRow</span><span class='kw'>=</span>-<span class='fl'>1</span>, <span class='kw'>offsetCol</span><span class='kw'>=</span>-<span class='fl'>1</span>)</div><div class='img'><img src='heatmap.2-32.png' alt='' width='700' height='433' /></div><div class='input'>

 <span class='co'>## Show how to use 'extrafun' to replace the 'key' with a scatterplot</span>
 <span class='no'>lmat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>,<span class='fl'>3</span>,<span class='fl'>4</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>4</span>) )
 <span class='no'>lhei</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.5</span>, <span class='fl'>4</span>)
 <span class='no'>lwid</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.5</span>, <span class='fl'>4</span>, <span class='fl'>0.75</span>)

 <span class='no'>myplot</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>() {
             <span class='no'>oldpar</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='st'>"mar"</span>)
             <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mar</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5.1</span>, <span class='fl'>4.1</span>, <span class='fl'>0.5</span>, <span class='fl'>0.5</span>))
             <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>mpg</span> ~ <span class='no'>hp</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>x</span>)
           }

 <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>lmat</span><span class='kw'>=</span><span class='no'>lmat</span>, <span class='kw'>lhei</span><span class='kw'>=</span><span class='no'>lhei</span>, <span class='kw'>lwid</span><span class='kw'>=</span><span class='no'>lwid</span>, <span class='kw'>key</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>extrafun</span><span class='kw'>=</span><span class='no'>myplot</span>)</div><div class='img'><img src='heatmap.2-33.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='co'>## show how to customize the color key</span>
 <span class='fu'>heatmap.2</span>(<span class='no'>x</span>,
           <span class='kw'>key.title</span><span class='kw'>=</span><span class='fl'>NA</span>, <span class='co'># no title</span>
           <span class='kw'>key.xlab</span><span class='kw'>=</span><span class='fl'>NA</span>,  <span class='co'># no xlab</span>
           <span class='kw'>key.par</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>mgp</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.5</span>, <span class='fl'>0.5</span>, <span class='fl'>0</span>),
                        <span class='kw'>mar</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2.5</span>, <span class='fl'>2.5</span>, <span class='fl'>1</span>, <span class='fl'>0</span>)),
           <span class='kw'>key.xtickfun</span><span class='kw'>=</span><span class='kw'>function</span>() {
                 <span class='no'>breaks</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sys.parent.html'>parent.frame</a></span>()$<span class='no'>breaks</span>
                 <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
                      <span class='kw'>at</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sys.parent.html'>parent.frame</a></span>()$<span class='fu'>scale01</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>breaks</span>[<span class='fl'>1</span>],
                                                  <span class='no'>breaks</span>[<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>breaks</span>)])),
                      <span class='kw'>labels</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='no'>breaks</span>[<span class='fl'>1</span>]),
                               <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='no'>breaks</span>[<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>breaks</span>)]))
                      ))
           })</div><div class='img'><img src='heatmap.2-34.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='fu'>heatmap.2</span>(<span class='no'>x</span>,
          <span class='kw'>breaks</span><span class='kw'>=</span><span class='fl'>256</span>,
          <span class='kw'>key.title</span><span class='kw'>=</span><span class='fl'>NA</span>,
          <span class='kw'>key.xlab</span><span class='kw'>=</span><span class='fl'>NA</span>,
          <span class='kw'>key.par</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>mgp</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.5</span>, <span class='fl'>0.5</span>, <span class='fl'>0</span>),
                       <span class='kw'>mar</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2.5</span>, <span class='fl'>1</span>, <span class='fl'>0</span>)),
          <span class='kw'>key.xtickfun</span><span class='kw'>=</span><span class='kw'>function</span>() {
               <span class='no'>cex</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='st'>"cex"</span>)*<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='st'>"cex.axis"</span>)
               <span class='no'>side</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>
               <span class='no'>line</span> <span class='kw'>&lt;-</span> <span class='fl'>0</span>
               <span class='no'>col</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='st'>"col.axis"</span>)
               <span class='no'>font</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='st'>"font.axis"</span>)
               <span class='fu'><a href='https://rdrr.io/r/graphics/mtext.html'>mtext</a></span>(<span class='st'>"low"</span>, <span class='kw'>side</span><span class='kw'>=</span><span class='no'>side</span>, <span class='kw'>at</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>adj</span><span class='kw'>=</span><span class='fl'>0</span>,
                     <span class='kw'>line</span><span class='kw'>=</span><span class='no'>line</span>, <span class='kw'>cex</span><span class='kw'>=</span><span class='no'>cex</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='no'>col</span>, <span class='kw'>font</span><span class='kw'>=</span><span class='no'>font</span>)
               <span class='fu'><a href='https://rdrr.io/r/graphics/mtext.html'>mtext</a></span>(<span class='st'>"high"</span>, <span class='kw'>side</span><span class='kw'>=</span><span class='no'>side</span>, <span class='kw'>at</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>adj</span><span class='kw'>=</span><span class='fl'>1</span>,
                     <span class='kw'>line</span><span class='kw'>=</span><span class='no'>line</span>, <span class='kw'>cex</span><span class='kw'>=</span><span class='no'>cex</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='no'>col</span>, <span class='kw'>font</span><span class='kw'>=</span><span class='no'>font</span>)
               <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>labels</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>tick</span><span class='kw'>=</span><span class='fl'>FALSE</span>))
          })</div><div class='img'><img src='heatmap.2-35.png' alt='' width='700' height='433' /></div><div class='input'>

 <span class='co'>##</span>
 <span class='co'>## Show effect of z-score scaling within columns, blue-red color scale</span>
 <span class='co'>##</span>
 <span class='no'>hv</span> <span class='kw'>&lt;-</span> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='no'>bluered</span>, <span class='kw'>scale</span><span class='kw'>=</span><span class='st'>"column"</span>, <span class='kw'>tracecol</span><span class='kw'>=</span><span class='st'>"#303030"</span>)</div><div class='img'><img src='heatmap.2-36.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='co'>###</span>
 <span class='co'>## Look at the return values</span>
 <span class='co'>###</span>
 <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>hv</span>)</div><div class='output co'>#&gt;  [1] "rowInd"        "colInd"        "call"          "colMeans"     
#&gt;  [5] "colSDs"        "carpet"        "rowDendrogram" "colDendrogram"
#&gt;  [9] "breaks"        "col"           "vline"         "colorTable"   
#&gt; [13] "layout"       </div><div class='input'>
 <span class='co'>## Show the mapping of z-score values to color bins</span>
 <span class='no'>hv</span>$<span class='no'>colorTable</span></div><div class='output co'>#&gt;           low       high   color
#&gt; 1  -3.2116766 -2.7834531 #0000FF
#&gt; 2  -2.7834531 -2.3552295 #2424FF
#&gt; 3  -2.3552295 -1.9270060 #4949FF
#&gt; 4  -1.9270060 -1.4987824 #6D6DFF
#&gt; 5  -1.4987824 -1.0705589 #9292FF
#&gt; 6  -1.0705589 -0.6423353 #B6B6FF
#&gt; 7  -0.6423353 -0.2141118 #DBDBFF
#&gt; 8  -0.2141118  0.2141118 #FFFFFF
#&gt; 9   0.2141118  0.6423353 #FFDBDB
#&gt; 10  0.6423353  1.0705589 #FFB6B6
#&gt; 11  1.0705589  1.4987824 #FF9292
#&gt; 12  1.4987824  1.9270060 #FF6D6D
#&gt; 13  1.9270060  2.3552295 #FF4949
#&gt; 14  2.3552295  2.7834531 #FF2424
#&gt; 15  2.7834531  3.2116766 #FF0000</div><div class='input'>
 <span class='co'>## Extract the range associated with white</span>
 <span class='no'>hv</span>$<span class='no'>colorTable</span>[<span class='no'>hv</span>$<span class='no'>colorTable</span>[,<span class='st'>"color"</span>]<span class='kw'>==</span><span class='st'>"#FFFFFF"</span>,]</div><div class='output co'>#&gt;          low      high   color
#&gt; 8 -0.2141118 0.2141118 #FFFFFF</div><div class='input'>
 <span class='co'>## Determine the original data values that map to white</span>
 <span class='no'>whiteBin</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span>(<span class='no'>hv</span>$<span class='no'>colorTable</span>[<span class='no'>hv</span>$<span class='no'>colorTable</span>[,<span class='st'>"color"</span>]<span class='kw'>==</span><span class='st'>"#FFFFFF"</span>,<span class='fl'>1</span>:<span class='fl'>2</span>])
 <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='no'>whiteBin</span>[<span class='fl'>1</span>] * <span class='no'>hv</span>$<span class='no'>colSDs</span> + <span class='no'>hv</span>$<span class='no'>colMeans</span>,
       <span class='no'>whiteBin</span>[<span class='fl'>2</span>] * <span class='no'>hv</span>$<span class='no'>colSDs</span> + <span class='no'>hv</span>$<span class='no'>colMeans</span> )</div><div class='output co'>#&gt;           cyl        am        vs     carb       wt     drat     gear     qsec
#&gt; [1,] 5.805113 0.2994102 0.3295842 2.466667 3.007751 3.482081 3.529527 17.46614
#&gt; [2,] 6.569887 0.5130898 0.5454158 3.158333 3.426749 3.711044 3.845473 18.23136
#&gt;           mpg       hp     disp
#&gt; [1,] 18.80018 132.0074 204.1851
#&gt; [2,] 21.38107 161.3676 257.2586</div><div class='input'> <span class='co'>##</span>
 <span class='co'>## A more decorative heatmap, with z-score scaling along columns</span>
 <span class='co'>##</span>
 <span class='no'>hv</span> <span class='kw'>&lt;-</span> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>cm.colors</a></span>(<span class='fl'>255</span>), <span class='kw'>scale</span><span class='kw'>=</span><span class='st'>"column"</span>,
               <span class='kw'>RowSideColors</span><span class='kw'>=</span><span class='no'>rc</span>, <span class='kw'>ColSideColors</span><span class='kw'>=</span><span class='no'>cc</span>, <span class='kw'>margin</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>, <span class='fl'>10</span>),
               <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"specification variables"</span>, <span class='kw'>ylab</span><span class='kw'>=</span> <span class='st'>"Car Models"</span>,
               <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"heatmap(&lt;Mtcars data&gt;, ..., scale=\"column\")"</span>,
         <span class='kw'>tracecol</span><span class='kw'>=</span><span class='st'>"green"</span>, <span class='kw'>density</span><span class='kw'>=</span><span class='st'>"density"</span>)</div><div class='img'><img src='heatmap.2-37.png' alt='' width='700' height='433' /></div><div class='input'> <span class='co'>## Note that the breakpoints are now symmetric about 0</span>

 <span class='co'>## Color the labels to match RowSideColors and ColSideColors</span>
 <span class='no'>hv</span> <span class='kw'>&lt;-</span> <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>cm.colors</a></span>(<span class='fl'>255</span>), <span class='kw'>scale</span><span class='kw'>=</span><span class='st'>"column"</span>,
         <span class='kw'>RowSideColors</span><span class='kw'>=</span><span class='no'>rc</span>, <span class='kw'>ColSideColors</span><span class='kw'>=</span><span class='no'>cc</span>, <span class='kw'>margin</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>, <span class='fl'>10</span>),
               <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"specification variables"</span>, <span class='kw'>ylab</span><span class='kw'>=</span> <span class='st'>"Car Models"</span>,
               <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"heatmap(&lt;Mtcars data&gt;, ..., scale=\"column\")"</span>,
         <span class='kw'>tracecol</span><span class='kw'>=</span><span class='st'>"green"</span>, <span class='kw'>density</span><span class='kw'>=</span><span class='st'>"density"</span>, <span class='kw'>colRow</span><span class='kw'>=</span><span class='no'>rc</span>, <span class='kw'>colCol</span><span class='kw'>=</span><span class='no'>cc</span>,
         <span class='kw'>srtCol</span><span class='kw'>=</span><span class='fl'>45</span>, <span class='kw'>adjCol</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.5</span>,<span class='fl'>1</span>))</div><div class='img'><img src='heatmap.2-38.png' alt='' width='700' height='433' /></div><div class='input'>




 <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>attitude</span>)
 <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='no'>Ca</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span>(<span class='no'>attitude</span>), <span class='fl'>2</span>)</div><div class='output co'>#&gt;            rating complaints privileges learning raises critical advance
#&gt; rating       1.00       0.83       0.43     0.62   0.59     0.16    0.16
#&gt; complaints   0.83       1.00       0.56     0.60   0.67     0.19    0.22
#&gt; privileges   0.43       0.56       1.00     0.49   0.45     0.15    0.34
#&gt; learning     0.62       0.60       0.49     1.00   0.64     0.12    0.53
#&gt; raises       0.59       0.67       0.45     0.64   1.00     0.38    0.57
#&gt; critical     0.16       0.19       0.15     0.12   0.38     1.00    0.28
#&gt; advance      0.16       0.22       0.34     0.53   0.57     0.28    1.00</div><div class='input'> <span class='fu'><a href='https://rdrr.io/r/stats/symnum.html'>symnum</a></span>(<span class='no'>Ca</span>) <span class='co'># simple graphic</span></div><div class='output co'>#&gt;            rt cm p l rs cr a
#&gt; rating     1                
#&gt; complaints +  1             
#&gt; privileges .  .  1          
#&gt; learning   ,  .  . 1        
#&gt; raises     .  ,  . , 1      
#&gt; critical             .  1   
#&gt; advance          . . .     1
#&gt; attr(,"legend")
#&gt; [1] 0 ‘ ’ 0.3 ‘.’ 0.6 ‘,’ 0.8 ‘+’ 0.9 ‘*’ 0.95 ‘B’ 1</div><div class='input'>
 <span class='co'># with reorder</span>
 <span class='fu'>heatmap.2</span>(<span class='no'>Ca</span>,           <span class='kw'>symm</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>margin</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>6</span>, <span class='fl'>6</span>), <span class='kw'>trace</span><span class='kw'>=</span><span class='st'>"none"</span> )</div><div class='img'><img src='heatmap.2-39.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='co'># without reorder</span>
 <span class='fu'>heatmap.2</span>(<span class='no'>Ca</span>, <span class='kw'>Rowv</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>symm</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>margin</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>6</span>, <span class='fl'>6</span>), <span class='kw'>trace</span><span class='kw'>=</span><span class='st'>"none"</span> )</div><div class='output co'>#&gt; <span class='warning'>Warning: Discrepancy: Rowv is FALSE, while dendrogram is `both'. Omitting row dendogram.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discrepancy: Colv is FALSE, while dendrogram is `column'. Omitting column dendogram.</span></div><div class='img'><img src='heatmap.2-40.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='co'>## Place the color key below the image plot</span>
 <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>lmat</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>3</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>1</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>4</span>) ), <span class='kw'>lhei</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.5</span>, <span class='fl'>4</span>, <span class='fl'>2</span> ) )</div><div class='input'>
 <span class='co'>## Place the color key to the top right of the image plot</span>
 <span class='fu'>heatmap.2</span>(<span class='no'>x</span>, <span class='kw'>lmat</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>3</span>, <span class='fl'>4</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>0</span> ) ), <span class='kw'>lwid</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.5</span>, <span class='fl'>4</span>, <span class='fl'>2</span> ) )</div><div class='img'><img src='heatmap.2-41.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='co'>## For variable clustering, rather use distance based on cor():</span>
 <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>USJudgeRatings</span>)
 <span class='fu'><a href='https://rdrr.io/r/stats/symnum.html'>symnum</a></span>( <span class='no'>cU</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span>(<span class='no'>USJudgeRatings</span>) )</div><div class='output co'>#&gt;      CO I DM DI CF DE PR F O W PH R
#&gt; CONT 1                             
#&gt; INTG    1                          
#&gt; DMNR    B 1                        
#&gt; DILG    + +  1                     
#&gt; CFMG    + +  B  1                  
#&gt; DECI    + +  B  B  1               
#&gt; PREP    + +  B  B  B  1            
#&gt; FAMI    + +  B  *  *  B  1         
#&gt; ORAL    * *  B  B  *  B  B 1       
#&gt; WRIT    * +  B  *  *  B  B B 1     
#&gt; PHYS    , ,  +  +  +  +  + + + 1   
#&gt; RTEN    * *  *  *  *  B  * B B *  1
#&gt; attr(,"legend")
#&gt; [1] 0 ‘ ’ 0.3 ‘.’ 0.6 ‘,’ 0.8 ‘+’ 0.9 ‘*’ 0.95 ‘B’ 1</div><div class='input'>
 <span class='no'>hU</span> <span class='kw'>&lt;-</span> <span class='fu'>heatmap.2</span>(<span class='no'>cU</span>, <span class='kw'>Rowv</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>symm</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>topo.colors</a></span>(<span class='fl'>16</span>),
              <span class='kw'>distfun</span><span class='kw'>=</span><span class='kw'>function</span>(<span class='no'>c</span>) <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>as.dist</a></span>(<span class='fl'>1</span> - <span class='no'>c</span>), <span class='kw'>trace</span><span class='kw'>=</span><span class='st'>"none"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Discrepancy: Rowv is FALSE, while dendrogram is `both'. Omitting row dendogram.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discrepancy: Colv is FALSE, while dendrogram is `column'. Omitting column dendogram.</span></div><div class='img'><img src='heatmap.2-42.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='co'>## The Correlation matrix with same reordering:</span>
 <span class='no'>hM</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='no'>cU</span>, <span class='fl'>2</span>))
 <span class='no'>hM</span></div><div class='output co'>#&gt;      CONT    INTG    DMNR    DILG    CFMG    DECI    PREP    FAMI    ORAL   
#&gt; CONT " 1.00" "-0.13" "-0.15" " 0.01" " 0.14" " 0.09" " 0.01" "-0.03" "-0.01"
#&gt; INTG "-0.13" " 1.00" " 0.96" " 0.87" " 0.81" " 0.80" " 0.88" " 0.87" " 0.91"
#&gt; DMNR "-0.15" " 0.96" " 1.00" " 0.84" " 0.81" " 0.80" " 0.86" " 0.84" " 0.91"
#&gt; DILG " 0.01" " 0.87" " 0.84" " 1.00" " 0.96" " 0.96" " 0.98" " 0.96" " 0.95"
#&gt; CFMG " 0.14" " 0.81" " 0.81" " 0.96" " 1.00" " 0.98" " 0.96" " 0.94" " 0.95"
#&gt; DECI " 0.09" " 0.80" " 0.80" " 0.96" " 0.98" " 1.00" " 0.96" " 0.94" " 0.95"
#&gt; PREP " 0.01" " 0.88" " 0.86" " 0.98" " 0.96" " 0.96" " 1.00" " 0.99" " 0.98"
#&gt; FAMI "-0.03" " 0.87" " 0.84" " 0.96" " 0.94" " 0.94" " 0.99" " 1.00" " 0.98"
#&gt; ORAL "-0.01" " 0.91" " 0.91" " 0.95" " 0.95" " 0.95" " 0.98" " 0.98" " 1.00"
#&gt; WRIT "-0.04" " 0.91" " 0.89" " 0.96" " 0.94" " 0.95" " 0.99" " 0.99" " 0.99"
#&gt; PHYS " 0.05" " 0.74" " 0.79" " 0.81" " 0.88" " 0.87" " 0.85" " 0.84" " 0.89"
#&gt; RTEN "-0.03" " 0.94" " 0.94" " 0.93" " 0.93" " 0.92" " 0.95" " 0.94" " 0.98"
#&gt;      WRIT    PHYS    RTEN   
#&gt; CONT "-0.04" " 0.05" "-0.03"
#&gt; INTG " 0.91" " 0.74" " 0.94"
#&gt; DMNR " 0.89" " 0.79" " 0.94"
#&gt; DILG " 0.96" " 0.81" " 0.93"
#&gt; CFMG " 0.94" " 0.88" " 0.93"
#&gt; DECI " 0.95" " 0.87" " 0.92"
#&gt; PREP " 0.99" " 0.85" " 0.95"
#&gt; FAMI " 0.99" " 0.84" " 0.94"
#&gt; ORAL " 0.99" " 0.89" " 0.98"
#&gt; WRIT " 1.00" " 0.86" " 0.97"
#&gt; PHYS " 0.86" " 1.00" " 0.91"
#&gt; RTEN " 0.97" " 0.91" " 1.00"</div><div class='input'>
 <span class='co'># now with the correlation matrix on the plot itself</span>

 <span class='fu'>heatmap.2</span>(<span class='no'>cU</span>, <span class='kw'>Rowv</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>symm</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span>(<span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>heat.colors</a></span>(<span class='fl'>16</span>)),
             <span class='kw'>distfun</span><span class='kw'>=</span><span class='kw'>function</span>(<span class='no'>c</span>) <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>as.dist</a></span>(<span class='fl'>1</span> - <span class='no'>c</span>), <span class='kw'>trace</span><span class='kw'>=</span><span class='st'>"none"</span>,
             <span class='kw'>cellnote</span><span class='kw'>=</span><span class='no'>hM</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Discrepancy: Rowv is FALSE, while dendrogram is `both'. Omitting row dendogram.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discrepancy: Colv is FALSE, while dendrogram is `column'. Omitting column dendogram.</span></div><div class='img'><img src='heatmap.2-43.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='co'>## genechip data examples</span>
 <span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
 <span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>affy</span>)
 <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>SpikeIn</span>)
 <span class='no'>pms</span> <span class='kw'>&lt;-</span> <span class='no'>SpikeIn</span>@<span class='kw'>pm</span>

 <span class='co'># just the data, scaled across rows</span>
 <span class='fu'>heatmap.2</span>(<span class='no'>pms</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span>(<span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>heat.colors</a></span>(<span class='fl'>16</span>)), <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"SpikeIn@pm"</span>,
              <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"Relative Concentration"</span>, <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"Probeset"</span>,
              <span class='kw'>scale</span><span class='kw'>=</span><span class='st'>"row"</span>)

 <span class='co'># fold change vs "12.50" sample</span>
 <span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='no'>pms</span> / <span class='no'>pms</span>[, <span class='st'>"12.50"</span>]
 <span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>data</span><span class='kw'>&gt;</span><span class='fl'>1</span>, <span class='no'>data</span>, -<span class='fl'>1</span>/<span class='no'>data</span>)
 <span class='fu'>heatmap.2</span>(<span class='no'>data</span>, <span class='kw'>breaks</span><span class='kw'>=</span><span class='fl'>16</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='no'>redgreen</span>, <span class='kw'>tracecol</span><span class='kw'>=</span><span class='st'>"blue"</span>,
               <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"SpikeIn@pm Fold Changes\nrelative to 12.50 sample"</span>,
               <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"Relative Concentration"</span>, <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"Probeset"</span>)
 }</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gregory R. Warnes, Ben Bolker, Lodewijk Bonebakker, Robert Gentleman, Wolfgang Huber, Andy Liaw, Thomas Lumley, Martin Maechler, Arni Magnusson, Steffen Moeller, Marc Schwartz, Bill Venables, Tal Galili.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


